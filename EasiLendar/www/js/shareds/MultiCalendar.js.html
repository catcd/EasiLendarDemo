<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for C:/CNPM/EasiLendar/EasiLendar/www/js/shareds/MultiCalendar.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../../../../../prettify.css">
    <link rel="stylesheet" href="../../../../../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header high">
    <h1>Code coverage report for <span class="entity">C:/CNPM/EasiLendar/EasiLendar/www/js/shareds/MultiCalendar.js</span></h1>
    <h2>
        Statements: <span class="metric">95.18% <small>(79 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">72.09% <small>(31 / 43)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">100% <small>(8 / 8)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">95.18% <small>(79 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../../index.html">All files</a> &#187; <a href="index.html">C:/CNPM/EasiLendar/EasiLendar/www/js/shareds/</a> &#187; MultiCalendar.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48</span>
<span class="cline-any cline-yes">1522</span>
<span class="cline-any cline-yes">150</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1372</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48</span>
<span class="cline-any cline-yes">48</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">47</span>
<span class="cline-any cline-yes">47</span>
<span class="cline-any cline-yes">79</span>
<span class="cline-any cline-yes">79</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">47</span>
<span class="cline-any cline-yes">47</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">47</span>
<span class="cline-any cline-yes">79</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">79</span>
<span class="cline-any cline-yes">131</span>
<span class="cline-any cline-yes">131</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">131</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">131</span>
<span class="cline-any cline-yes">68</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">68</span>
<span class="cline-any cline-yes">18</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">131</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">131</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">47</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">289</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">50</span>
<span class="cline-any cline-yes">68</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">357</span>
<span class="cline-any cline-yes">357</span>
<span class="cline-any cline-yes">357</span>
<span class="cline-any cline-yes">251</span>
<span class="cline-any cline-yes">75</span>
<span class="cline-any cline-yes">75</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">357</span>
<span class="cline-any cline-yes">57</span>
<span class="cline-any cline-yes">57</span>
<span class="cline-any cline-yes">57</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">357</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">357</span>
<span class="cline-any cline-yes">357</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">176</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">66</span>
<span class="cline-any cline-yes">63</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">110</span>
<span class="cline-any cline-yes">110</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">181</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * starter: Can Duy Cat
 * owner: Nguyen Minh Trang
 * last update: 12/05/2015
 * type: multi calendar object and specific function for calendar
 */
&nbsp;
var multiCalendar = angular.module('MainApp.shareds.multiCalendar', []);
&nbsp;
multiCalendar.factory('eMultiCalendar', function($rootScope, eEasiLendar) {
	// check if obj is null/undefined/'' or not
	var isNull = function(obj) {
		if (obj === null || obj === undefined || obj === '') {
			return true;
		}
		return false;
	};
	/*
	 * class MultiCal
	 * items is array of all calendar (pointer)
	 * calendar is the array itself
	 */
	function MultiCal(items) {
		/*
		 * PRIVATE
		 * set multiCalendar
		 */
		var setMultiCal = function() {
			if (isNull(items)) {
				return null;
			}
			// copy items because it's pointer
			var tempItems = [];
			for (var i=0; i &lt; items.length; i++) {
				tempItems[i] = [];
				for (var x in items[i]) {
					<span class="missing-if-branch" title="else path not taken" >E</span>if (items[i].hasOwnProperty(x)) {
						tempItems[i][x] = angular.copy(items[i][x]);
					}
				}
			}
			// array of arrays of events
			var cal = [];
			<span class="missing-if-branch" title="if path not taken" >I</span>if (isNull(tempItems)) {
<span class="cstat-no" title="statement not covered" >				return null;</span>
			}
			for (var i=0; i &lt; tempItems.length; i++) {
				<span class="missing-if-branch" title="else path not taken" >E</span>if (!isNull(tempItems[i])) {
					// tempItems[i] is standard to compare with
					for (var j in tempItems[i]) {
						<span class="missing-if-branch" title="else path not taken" >E</span>if (tempItems[i].hasOwnProperty(j)) {
							var temp = new BusyDay(tempItems[i][j]);
							// if "j" doesn't has any normal event
							<span class="missing-if-branch" title="if path not taken" >I</span>if (isNull(temp.events)) {
<span class="cstat-no" title="statement not covered" >								continue;</span>
							}
							// go through others
							for (var k = i+1; k &lt; tempItems.length; k++) {
								<span class="missing-if-branch" title="else path not taken" >E</span>if (!isNull(tempItems[k])) {
									// if tempItems[k] doesn't have "j"
									if (isNull(tempItems[k][j])) { 
										break; 
									} else {
										temp = new BusyDay(temp.events,
															tempItems[k][j]);
										// delete it so it won't 
										// be compared next time
										delete tempItems[k][j];
									}
								}
							}
							cal[j] = temp.events;
							// delete it so it won't be compared next time
							delete tempItems[i][j];
						}
					}
				}
			}
			return cal;
		};
		
		this.calendar = setMultiCal();
	}
&nbsp;
	/*
	 * Busy Day class
	 * day1, day2 is array of events 
	 * different calendar or different id
	 */
	function BusyDay (day1, day2) {
		/*
		 * PRIVATE
		 * sort event base on start.dateTime increasing
		 * of 2 array day1 and day2
		 */
		var sort = function() {
			// array of the sorted events
			var list = [];
			// combine 2 array into 1 array list
			<span class="missing-if-branch" title="else path not taken" >E</span>if (!isNull(day1)) {
				for (var i = 0; i &lt; day1.length; i++) {
					list[i] = day1[i];
				}
			}
			if (!isNull(day2)) {
				for (var i = 0; i &lt; day2.length; i++) {
					list[list.length] = day2[i];
				}
			}
			// sort list array
			for (var i=0; i &lt; list.length; i++) {
				var min = list[i];
				var pos = i;
				for (var j=i+1; j &lt; list.length; j++) {
					if (list[j].start.dateTime &lt; min.start.dateTime) {
							min = list[j];
							pos = j;
					}
				}
				if (pos != i) {
					var temp = list[i];
					list[i] = list[pos];
					list[pos] = temp;
				}
			}
			// convert all event to BusyEvent
			for (var i = 0; i &lt; list.length; i++) {
				list[i] = eEasiLendar.newBusyEvent(list[i].start, list[i].end);
			}
			var tempList = [];
			for (var i = 0; i &lt; list.length; i++) {
				<span class="missing-if-branch" title="else path not taken" >E</span>if (!isNull(list[i].start)) {
					tempList[tempList.length] = list[i];
				}
			}
			<span class="missing-if-branch" title="if path not taken" >I</span>if (tempList.length === 0) {
<span class="cstat-no" title="statement not covered" >				return null;</span>
			}
			return tempList;
		};
&nbsp;
		/*
		 * PRIVATE
		 * set events in this day
		 */
		var setEvent = function() {
			<span class="missing-if-branch" title="if path not taken" >I</span>if (isNull(day1) &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >isNull(day2))</span> {
<span class="cstat-no" title="statement not covered" >				return null;</span>
			}
			var events = [];
			var list = sort();	// list of all event (dateTime increasing)
			<span class="missing-if-branch" title="else path not taken" >E</span>if (!isNull(list)) {
				var temp = list[0];
				for (var i=1; i &lt; list.length; i++) {
					// if we can combime list[i] and temp as 1 busy event
					if (list[i].start.dateTime &lt;= temp.end.dateTime) {
						// list[i] is not completely inside temp's interval
						if (list[i].end.dateTime &gt;= temp.end.dateTime) {
							temp = eEasiLendar.newBusyEvent(temp.start,
																list[i].end);
						}
					} else {
						events[events.length] = temp;
						temp = list[i];
					}
				}
				events[events.length] = temp;
				return events;
			}
		};
		// array of BusyEvent in this day
		this.events = setEvent();
	}
&nbsp;
	return {
		/*
		 * items is array of all calendar
		 * the calendar is the array itself
		 */
		newMultiCal: function(items) {
			return new MultiCal(items);
		},
	};
});</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Wed May 13 2015 04:05:11 GMT+0700 (SE Asia Standard Time)</div>
</div>
<script src="../../../../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../../../../sorter.js"></script>
</body>
</html>
